# 繁體中文註解：使用 Docker Compose 一鍵啟動前端、後端與 PostgreSQL。
services:
  db:
    image: postgres:15
    environment:
      POSTGRES_DB: demohotel
      POSTGRES_USER: demohotel
      POSTGRES_PASSWORD: demohotel
    volumes:
      - db_data:/var/lib/postgresql/data
    #ports:
    #  - "5432:5432"

  backend:
    build:
      context: ./backend
      target: development
    depends_on:
      - db
    environment:
      DB_URL: jdbc:postgresql://db:5432/demohotel
      DB_USERNAME: demohotel
      DB_PASSWORD: demohotel
      WALLET_ISSUER_ACCESS_TOKEN: iZpu42gbRAyAWuGGHGBXlE7KSVWPEhz5
      WALLET_VERIFIER_ACCESS_TOKEN: duCrxCUexuxUJtg4OPKdIWlK7iLhKicy
    volumes:
      - ./backend:/workspace
      - backend_maven_repo:/root/.m2
    ports:
      - "8080:8080"

  frontend:
    build:
      context: ./frontend
      target: development
    depends_on:
      - backend
    environment:
      ROLLUP_SKIP_NODEJS_NATIVE: "1"
      VITE_BACKEND_ORIGIN: http://backend:8080
    volumes:
      - ./frontend:/app
      - frontend_node_modules:/app/node_modules
    ports:
      - "5173:5173"

volumes:
  db_data:
  frontend_node_modules:
  backend_maven_repo:
